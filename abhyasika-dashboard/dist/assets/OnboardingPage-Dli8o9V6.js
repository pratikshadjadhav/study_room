import{r as m,d as N,j as e,L as c}from"./index-DTs48n8C.js";const v=["Morning","Afternoon","Evening","Day"],C=[{value:"monthly",label:"Monthly Membership"},{value:"limited",label:"Limited Days"}],P=[{value:"calendar",label:"1st - 30th"},{value:"rolling",label:"Rolling 30 days"}];function S(){const f=m.useMemo(()=>N(),[]),[u,g]=m.useState(!1),[x,a]=m.useState({tone:"",message:""}),[t,o]=m.useState({name:"",phone:"",email:"",gender:"",aadhaar:"",pan:"",address:"",city:"",state:"",pincode:"",attachPhoto:!1,photoFile:null,preferredShift:"Morning",planType:"monthly",limitedDays:"",billingCycle:"calendar",registrationPaid:!1,joinDate:new Date().toISOString().slice(0,10)}),n=s=>{const{name:l,value:r}=s.target;o(i=>({...i,[l]:r}))},b=s=>{o(l=>({...l,[s]:!l[s]}))},j=s=>{var r;const l=((r=s.target.files)==null?void 0:r[0])??null;o(i=>({...i,photoFile:l}))},p=t.phone.replace(/\D/g,""),h=t.aadhaar.replace(/\D/g,""),y=async s=>{s.preventDefault(),a({tone:"",message:""});const l=/.+@.+\..+/,r=/^[A-Z]{5}\d{4}[A-Z]$/,i=/^\d{6}$/;if(!t.name.trim()){a({tone:"error",message:"Full name is required."});return}if(p.length!==10){a({tone:"error",message:"Phone number must be 10 digits."});return}if(t.email&&!l.test(t.email.trim())){a({tone:"error",message:"Enter a valid email address."});return}if(!t.gender){a({tone:"error",message:"Please select a gender."});return}if(h.length!==12){a({tone:"error",message:"Aadhaar number must be 12 digits."});return}if(!r.test(t.pan.trim().toUpperCase())){a({tone:"error",message:"PAN must follow the format ABCDE1234F."});return}if(!t.address.trim()||!t.city.trim()||!t.state.trim()){a({tone:"error",message:"Address, city, and state are required."});return}if(!i.test(t.pincode.trim())){a({tone:"error",message:"Pincode must be 6 digits."});return}if(!t.joinDate){a({tone:"error",message:"Please select a joining date."});return}if(t.attachPhoto){if(!t.photoFile){a({tone:"error",message:"Attach an Aadhaar photo."});return}if(!["image/jpeg","image/png","image/webp"].includes(t.photoFile.type)){a({tone:"error",message:"Photo must be JPEG, PNG, or WEBP."});return}if(t.photoFile.size>2*1024*1024){a({tone:"error",message:"Photo must be under 2 MB."});return}}try{g(!0),await f.createStudent({name:t.name.trim(),phone:p,email:t.email.trim(),gender:t.gender,aadhaar:h,pan_card:t.pan.trim().toUpperCase(),address:t.address.trim(),city:t.city.trim(),state:t.state.trim(),pincode:t.pincode.trim(),preferred_shift:t.preferredShift,fee_plan_type:t.planType,fee_cycle:t.billingCycle,limited_days:t.planType==="limited"&&Number(t.limitedDays)||null,registration_paid:t.registrationPaid,join_date:t.joinDate,registration_source:"qr_self",registered_by_role:"Self"}),a({tone:"success",message:"Thanks! Your enrollment has been submitted."}),o(d=>({...d,name:"",phone:"",email:"",gender:"",aadhaar:"",pan:"",address:"",city:"",state:"",pincode:"",attachPhoto:!1,photoFile:null,preferredShift:"Morning",planType:"monthly",limitedDays:"",billingCycle:"calendar",registrationPaid:!1,joinDate:new Date().toISOString().slice(0,10)})),window.scrollTo({top:0,behavior:"smooth"})}catch(d){a({tone:"error",message:d.message??"Unable to submit enrollment."})}finally{g(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-indigo-50 via-white to-slate-50 px-4 py-10 sm:px-6 lg:px-0",children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl rounded-3xl border border-slate-100 bg-white/90 p-6 shadow-xl shadow-indigo-100",children:[e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-indigo-500",children:"Abhyasika Enrollment"}),e.jsx("h1",{className:"text-3xl font-semibold text-slate-900",children:"Create New Student"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Please fill in your details. We’ll confirm your seat and plan shortly."})]}),x.message?e.jsx("div",{className:`mt-6 rounded-2xl border px-4 py-3 text-sm ${x.tone==="success"?"border-emerald-100 bg-emerald-50 text-emerald-700":"border-rose-100 bg-rose-50 text-rose-700"}`,children:x.message}):null,e.jsxs("form",{className:"mt-8 space-y-8",onSubmit:y,children:[e.jsxs("section",{className:"space-y-4 rounded-3xl border border-slate-100 bg-slate-50/70 p-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-indigo-100 text-indigo-600",children:e.jsx(c,{name:"userPlus",className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Student Details"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Basic contact and identity information."})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Full Name",e.jsx("input",{name:"name",value:t.name,onChange:n,placeholder:"Enter full name",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Phone Number",e.jsx("input",{name:"phone",value:t.phone,onChange:n,placeholder:"9876543210",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Email",e.jsx("input",{name:"email",type:"email",value:t.email,onChange:n,placeholder:"Email address",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Gender",e.jsxs("select",{name:"gender",value:t.gender,onChange:n,className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Aadhaar Number",e.jsx("input",{name:"aadhaar",value:t.aadhaar,onChange:n,placeholder:"1234 5678 9012",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["PAN Card Number",e.jsx("input",{name:"pan",value:t.pan,onChange:n,placeholder:"ABCDE1234F",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100 uppercase"})]})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Address",e.jsx("input",{name:"address",value:t.address,onChange:n,placeholder:"Flat / Street / Landmark",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["City",e.jsx("input",{name:"city",value:t.city,onChange:n,placeholder:"City",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["State",e.jsx("input",{name:"state",value:t.state,onChange:n,placeholder:"State",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Pincode",e.jsx("input",{name:"pincode",value:t.pincode,onChange:n,placeholder:"6-digit pin",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Joining Date",e.jsx("input",{type:"date",name:"joinDate",value:t.joinDate,onChange:n,className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}),e.jsxs("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-white/80 p-4",children:[e.jsxs("label",{className:"flex items-center justify-between text-sm font-semibold text-slate-700",children:["Attach Aadhaar photo (JPEG/PNG/WEBP, under 2 MB)",e.jsx("button",{type:"button",onClick:()=>b("attachPhoto"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${t.attachPhoto?"bg-indigo-600":"bg-slate-200"}`,children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${t.attachPhoto?"translate-x-5":"translate-x-1"}`})})]}),t.attachPhoto?e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/webp",onChange:j,className:"mt-3 text-sm text-slate-600"}):null]})]}),e.jsxs("section",{className:"space-y-4 rounded-3xl border border-slate-100 bg-slate-50/70 p-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-2xl bg-emerald-100 text-emerald-600",children:e.jsx(c,{name:"calendarCheck",className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"Schedule"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Pick your preferred shift and billing cycle."})]})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Preferred Shift",e.jsx("select",{name:"preferredShift",value:t.preferredShift,onChange:n,className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100",children:v.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Plan Type",e.jsx("select",{name:"planType",value:t.planType,onChange:n,className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100",children:C.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Billing Cycle",e.jsx("select",{name:"billingCycle",value:t.billingCycle,onChange:n,className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100",children:P.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]}),t.planType==="limited"?e.jsxs("label",{className:"flex flex-col text-sm font-medium text-slate-700",children:["Limited Plan Duration (days)",e.jsx("input",{name:"limitedDays",value:t.limitedDays,onChange:n,placeholder:"15",className:"mt-1 rounded-xl border border-slate-200 px-3 py-2 text-sm text-slate-700 outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-100"})]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Aadhaar & personal data are used only for verification and onboarding."}),e.jsx("button",{type:"submit",disabled:u,className:"inline-flex items-center gap-2 rounded-2xl bg-indigo-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-500 disabled:opacity-60",children:u?e.jsxs(e.Fragment,{children:[e.jsx(c,{name:"loader",className:"h-4 w-4 animate-spin"}),"Submitting…"]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{name:"send",className:"h-4 w-4"}),"Submit Enrollment"]})})]})]})]})})}export{S as default};
